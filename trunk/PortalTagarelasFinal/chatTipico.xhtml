<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
<link type="text/css" rel="stylesheet" media="all" href="css/style.css" charset="utf-8" /> 
<link type="text/css" rel="stylesheet" media="all" href="css/$.css" charset="utf-8" /> 
<link type="text/css" rel="stylesheet" media="all" href="js/ui/jquery.ui.button.css" charset="utf-8" />

<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/jquery-ui.js"></script> 
<script type="text/javascript" src="js/jquery.autosize.js"></script>
<script type="text/javascript" src="js/jquery.emotions.js"></script>
<script type="text/javascript" src="js/ui/jquery.ui.dialog.js"></script>
<script type="text/javascript" src="js/jqModal.js"></script>
<script type="text/javascript" language="Javascript">   
	function clickSearchButton(e) {  
		var e=window.event || e;
        var keyunicode=e.keyCode || e.charCode;
    	if (keyunicode == 13){  
    		alert("ttt" + $("#digitacao").value);
            // alert("Ener key pressed in pressTheClick");  // I can see this alert  
            document.getElementById("btn").click();  
    	} 
	}  
</script>  
<script language="JavaScript">  
	$(document).ready(function() {
		$("#btn").click(function() {
			var x = $("#digitacao").val();
			var dt = new Date();
			var currentTime = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
			var isEnd = $("#mensagens_Chat")[0].offsetHeight + $("#mensagens_Chat")[0].scrollTop == $("#mensagens_Chat")[0].scrollHeight;
			/* append message and scroll */
			//$('#mensagens_Chat').append("&lt;div id=\"dialogo_" + ($(".dial").size()+1) + "\"" + "style=\"margin-left: 0; border-top:1px solid #eee\"" + "class=\"arrowchat_chatboxmessagecontent arrowchat_self dial\"" + "&gt;" + "&lt;span id=\"hora_" + ($(".dial").size()+1) +"\" class=\"arrowchat_ts\" style=\"float:right;\"&gt;" +  currentTime + "&lt;/span&gt;" + "&lt;img src=\"images/img-no-avatar.gif\" class=\"arrowchat_userlist_foto\"" + "/&gt;" + "&lt;strong&gt;Convidado&lt;/strong&gt;" + "&lt;/br&gt;" + "&lt;div&gt;" + x + "&lt;/div&gt;" + "&lt;br clear=\"all\"&gt;" + "&lt;/div&gt;");		
				
			if(isEnd){
				var scroll = $("#mensagens_Chat").prop("scrollHeight") - $('#mensagens_Chat').height()
				$("#mensagens_Chat").scrollTop(scroll)  
			}
			//$('form').submit();
			$("#digitacao").val("");
			var divList = $("div[id^='dialogo_']");
			jQuery.each(divList, function (i, val) {
				i = i + 1;
				$('#dialogo_' + i).mouseover(function() {
					$('#hora_' + i).css('display', 'block');
				});
				$('#dialogo_' + i).mouseout(function() {
					$('#hora_' + i).css('display', 'none');
				});
			});	
			$("#digitacao").focus();
			//return false;
		});
				
		$("#btnResponder").click(function() {
			var x = $("#digitacao").val();
			var dt = new Date();
			var currentTime = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
			var isEnd = $("#mensagens_Chat")[0].offsetHeight + $("#mensagens_Chat")[0].scrollTop == $("#mensagens_Chat")[0].scrollHeight;
			/* append message and scroll */
			//$('#mensagens_Chat').append("&lt;div id=\"dialogo_" + ($(".dial").size()+1) + "\"" + "style=\"margin-left: 0; border-top:1px solid #eee\"" + "class=\"arrowchat_chatboxmessagecontent arrowchat_self dial\"" + "&gt;" + "&lt;span id=\"hora_" + ($(".dial").size()+1) +"\" class=\"arrowchat_ts\" style=\"float:right;\"&gt;" +  currentTime + "&lt;/span&gt;" + "&lt;img src=\"images/img-no-avatar.gif\" class=\"arrowchat_userlist_foto\"" + "/&gt;" + "&lt;strong&gt;Convidado&lt;/strong&gt;" + "&lt;/br&gt;" + "&lt;div&gt;" + x + "&lt;/div&gt;" + "&lt;br clear=\"all\"&gt;" + "&lt;/div&gt;");		
			if(isEnd){
				var scroll = $("#mensagens_Chat").prop("scrollHeight") - $('#mensagens_Chat').height()
				$("#mensagens_Chat").scrollTop(scroll)  
			}
			//$('form').submit();
			$("#digitacao").val("");
			var divList = $("div[id^='dialogo_']");
			jQuery.each(divList, function (i, val) {
				i = i + 1;
				$('#dialogo_' + i).mouseover(function() {
					$('#hora_' + i).css('display', 'block');
				});
				$('#dialogo_' + i).mouseout(function() {
					  $('#hora_' + i).css('display', 'none');
				});
			});	
			$("#digitacao").focus();
			//return false;
		});
	   
		//if (event.keyCode == 13){
		//	$("#btn").click();
		//}
		
		$('#digitacao').keyup(function (event) {
			if (event.keyCode == 13 &amp;&amp; event.shiftKey) {
				var content = this.value;
				var caret = getCaret(this);
				this.value = content.substring(0,caret)+"\n"+content.substring(carent,content.length-1);
				event.stopPropagation();
			}
			else if(event.keyCode == 13){		
				var x = $("#digitacao").val();
				var dt = new Date();
				var currentTime = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
				var isEnd = $("#mensagens_Chat")[0].offsetHeight + $("#mensagens_Chat")[0].scrollTop == $("#mensagens_Chat")[0].scrollHeight;
				/*append message and scroll */
		  		//document.getElementById("msgH").value  = x;
         		//$("#btn").click();
				//$('#mensagens_Chat').append("&lt;div id=\"dialogo_" + ($(".dial").size()+1) + "\"" + "style=\"margin-left: 0; border-top:1px solid #eee\"" + "class=\"arrowchat_chatboxmessagecontent arrowchat_self dial\"" + "&gt;" + "&lt;span id=\"hora_" + ($(".dial").size()+1) +"\" class=\"arrowchat_ts\" style=\"float:right;\"&gt;" +  currentTime + "&lt;/span&gt;" + "&lt;img src=\"images/img-no-avatar.gif\" class=\"arrowchat_userlist_foto\"" + "/&gt;" + "&lt;strong&gt;Convidado&lt;/strong&gt;" + "&lt;/br&gt;" + "&lt;div&gt;" + x + "&lt;/div&gt;" + "&lt;br clear=\"all\"&gt;" + "&lt;/div&gt;");
				if(isEnd){
					var scroll = $("#mensagens_Chat").prop("scrollHeight") - $('#mensagens_Chat').height()
					$("#mensagens_Chat").scrollTop(scroll)  
				}
				//$('form').submit();
				$("#digitacao").val("");
				
				var divList = $("div[id^='dialogo_']");
				jQuery.each(divList, function (i, val) {
					i = i + 1;
					$('#dialogo_' + i).mouseover(function() {
						$('#hora_' + i).css('display', 'block');
					});
					$('#dialogo_' + i).mouseout(function() {
						$('#hora_' + i).css('display', 'none');
					});
				});
			}
		});
		
		function getCaret(el) { 
			if (el.selectionStart) { 
				return el.selectionStart; 
			}
			else if (document.selection) { 
				el.focus(); 
				var r = document.selection.createRange(); 
				if (r == null) { 
				  return 0; 
				} 
				var re = el.createTextRange(), rc = re.duplicate(); 
				re.moveToBookmark(r.getBookmark()); 
				rc.setEndPoint('EndToStart', re); 

				return rc.text.length; 
			}
			return 0; 
		}
		
		var divList = $("div[id^='dialogo_']");
		jQuery.each(divList, function (i, val) {
			i = i + 1;
			$('#dialogo_' + i).mouseover(function() {
				$('#hora_' + i).css('display', 'block');
			});
			$('#dialogo_' + i).mouseout(function() {
				$('#hora_' + i).css('display', 'none');
			});
		});
		
		$( "#divVerificaSessao" ).dialog({
			modal: true,
	    	closeOnEscape: false,
	    	open: function() { 
	    		$(".ui-dialog-titlebar-close").hide();
	    	},
	    	resizable: false,
	    	overlay: {
	        	opacity: 7,
	        	background: "black"
	        },
	        autoOpen: false
		});
		
		sessaoExpirada = getCookie("sessaoExpirada");
		
		if(sessaoExpirada == "sim"){
			$( "#divVerificaSessao" ).dialog("open");
		}
		
		if(idUsuario == idUsuarioAdm){
			setInterval(function() { validaTempoSessao(); }, 1000);
		}
	});
</script>
	
<script language="JAVASCRIPT" >
	var idAgenda = #{agendaBean.idAgenda};
	var idUsuario = #{loginBean.usuario.idUsuario};
	var idUsuarioAdm = #{salaChatBean.agenda.idUsuario};
	var url = "#{loginBean.usuario.url}";
	var nomeUsuario = "#{loginBean.usuario.nomeUsuario}";
	var idPai = #{salaChatBean.idPai};
	var comecou = false;
	var tempoIni = 0;
	var caracter = 0;
	var texto = "";
	var horaF = "";
	var shift = false;
	var flag = true;
	var tm = 0;
	var tempoFim = 0;
	var flagEnviar = false;
	
	var tempoSessao = "#{salaChatBean.agenda.tempoSessao}";
	var horaTerminoSessao = "#{salaChatBean.agenda.hora}";
	var horaServidor = "#{salaChatBean.horaServidor}";
	var data1 = new Date();
	var data2 = new Date();
	var fimSessao = horaTerminoSessao.split(":");
	var servidor = horaServidor.split(":");
	var auxSegServ = servidor[2];
	var auxMinServ = servidor[1];
	var auxHoraServ = servidor[0];
	var auxTempoSessao = 0;
	var sessaoExpirada;
	
	function enviaMensagem(){
		if (!comecou){
			return;
		}
	
		comecou = false;
		//var tempoFim = new Date;
		//var tm;
		tm = (tempoFim - tempoIni)/1000;
		tempoIni = 0;
		flag = true;
		//alert(document.formChat.digitacao.value);
		if(flagEnviar){
			 //alert(document.getElementById("msgTempo").value);
			document.formChat.btn.onclick();
		}
	
		document.getElementById("chatList").innerHTML = "";
		document.getElementById("chatList").innerHTML = "tempo de escrita: " + tm + " segundos";
		document.formChat.digitacao.value = "";
		document.formChat.msgTempoTotal.value = tm;
		document.formChat.msgTempo.value = "";
		texto = "";
		flagEnviar = false;
		cancelarResposta("*", 0);
	} 

	function clickLink(){
		alert("esta no alerta");
	}
	
	function ampliarSessao(){
		tempoSessao = $("#tempoAdicionalSessao").val();
		if(tempoSessao == ""){
			tempoSessao = 0;
		}
		auxTempoSessao = 0;
		$( "#divVerificaSessao" ).dialog("close");
		$("#tempoAdicionalSessao").val("");
		setCookie("sessaoExpirada","não",null);
	}
	
	function setCookie(c_name,value,exdays){
		var exdate=new Date();
		exdate.setDate(exdate.getDate() + exdays);
		var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
		document.cookie=c_name + "=" + c_value;
	}
	
	function getCookie(c_name){
		var c_value = document.cookie;
		var c_start = c_value.indexOf(" " + c_name + "=");
		if (c_start == -1){
		  	c_start = c_value.indexOf(c_name + "=");
		}
		if (c_start == -1){
			c_value = null;
		}
		else{
		  	c_start = c_value.indexOf("=", c_start) + 1;
		  	var c_end = c_value.indexOf(";", c_start);
		  	if (c_end == -1){
				c_end = c_value.length;
			}
			c_value = unescape(c_value.substring(c_start,c_end));
		}
		return c_value;
	}
	
	function validaTempoSessao(){
		if(auxTempoSessao >= tempoSessao){
			setCookie("sessaoExpirada","sim",null);
			$(function() {
				$( "#divVerificaSessao" ).dialog("open");
			});
		}
		else{
			auxTempoSessao++;
		}
		
		/*data1.setHours(auxHoraServ);
		data1.setMinutes(auxMinServ);
		data1.setSeconds(auxSegServ);
		
		data2.setHours(fimSessao[0]);
		data2.setMinutes(fimSessao[1]);
		data2.setSeconds(fimSessao[2]);
		
		if(data1.getSeconds() == data2.getSeconds()){
			$(function() {
				$( "#divVerificaSessao" ).dialog({
					height: 140,
			    	modal: true,
			    	closeOnEscape: false,
			    	open: function(event, ui) { $(".ui-dialog-titlebar-close").hide(); },
			    	resizable: false
				});
			});
		}
		
		if(auxSegServ == 60){
			auxSegServ = 0;
			if(auxMinServ == 60){
				auxMinServ = 0;
				if(auxHoraServ == 23){
					auxHoraServ = 0;
				}
				else
					auxHoraServ++;
			}
			else
				auxMinServ++;
		}
		else
			auxSegServ++;*/
	}

	function VerificaKeypress(e){
		if(window.event) { // IE
			keynum = e.keyCode;
			
		}else if(e.which) { // Netscape/Firefox/Opera
			keynum = e.which;
			
		}
		
		caracter = String.fromCharCode(keynum);
		
		if (caracter == " "){
			caracter = String.fromCharCode(183);
		}
		ExibePagina();
	}

	function formataHora(h){
		var horas = h.getHours();
		var minutos = h.getMinutes();
		var segundos = h.getSeconds();
		var milisegundos = h.getMilliseconds();
		var hf;
		
		hf = horas + ":" + minutos + ":" + segundos + ":" + milisegundos;
		return hf;
	}

	function responderMensagem(idMensagemPai, nivelResposta){
		$("#submit").hide("fast");
		$("#submitResposta").show("fast");
		$("#cancelarResposta_"+idMensagemPai).show("fast");
		$("#escreverResposta_"+idMensagemPai).hide("fast");
		
		$("#flgResposta").val("1");
		$("#idMensagemPai").val(idMensagemPai);
		$("#nivelResposta").val(nivelResposta);
	}

	function cancelarResposta(idMensagemPai, nivelResposta){
		$("#submit").show("fast");
		$("#submitResposta").hide("fast");
		$("#cancelarResposta_"+idMensagemPai).hide("fast");
		$("#escreverResposta_"+idMensagemPai).show("fast");
		
		$("#flgResposta").val("0");
		$("#idMensagemPai").val("0");
		$("#nivelResposta").val(nivelResposta);
	}
	
	function exibirRespostas(idMensagem){
		$("#divResp_"+idMensagem).show("fast");
		$("#exibirRespostas_"+idMensagem).hide("fast");
		$("#ocultarRespostas_"+idMensagem).show("fast");
	}
	
	function ocultarRespostas(idMensagem){
		$("#divResp_"+idMensagem).hide("fast");
		$("#exibirRespostas_"+idMensagem).show("fast");
		$("#ocultarRespostas_"+idMensagem).hide("fast");
	}

	function VerificaKeyDown(e){
		var keynum;
		
		if(window.event) { // IE
			keynum = e.keyCode;
		}else if(e.which) { // Netscape/Firefox/Opera
			keynum = e.which;
		}
		if (keynum == 13){
			if($("#flgResposta").val() == 1){
				mojarra.jsfcljs(document.getElementById('formChat'),{'btnResponder':'btnResponder','idAgenda':idAgenda,'idUsuario':idUsuario,'url':url,'flgResposta':$("#flgResposta").val(),'idMensagemPai':$("#idMensagemPai").val(),'nivelResposta':$("#nivelResposta").val()},'');
				cancelarResposta("*", $("#nivelResposta").val());
			}
			else{
				mojarra.jsfcljs(document.getElementById('formChat'),{'btn':'btn','idAgenda':idAgenda,'idUsuario':idUsuario,'url':url,'flgResposta':$("#flgResposta").val(),'idMensagemPai':$("#idMensagemPai").val(),'nivelResposta':$("#nivelResposta").val()},'');
			}
			return false;
		}
	
		if (keynum == 16){
			shift = true;
		}
	
		texto = document.formChat.digitacao.value.replace(/ /gi, String.fromCharCode(183));
			
		if (keynum == 8) {
			caracter = "BACKSPACE";
		}else if (keynum == 36) {
			caracter = "HOME";
		}else if (keynum == 45) {
			caracter = "INSERT";
		}else if (keynum == 46) {
			caracter = "DELETE";
		}else if (keynum == 35) {
			caracter = "END";
		}else if (keynum == 39) {
			caracter = "SETA DIR";
		}else if (keynum == 37) {
			caracter = "SETA ESQ";
		}else if (keynum == 222) {
			if (shift) {
				caracter = "^";
			}else{
				caracter = "~";
			}
		}else if (keynum == 219) {
			if (shift) {
				caracter = "`";
			}else {
				caracter = "´";
			}
		}
	
		// se for verdadeiro comecei agora a digitar e nao dei o enviar ainda
		if(flag){
			var horaT = new Date;
			tempoIni = horaT;
			flag = false;
		}
		var hora = new Date;
		tempoFim = new Date;
		//if (tempoIni == 0){
		//	tempoIni = hora;
		//}

		horaF = formataHora(hora);

		if (caracter != ""){
			ExibePagina();
		}
	}

	function VerificaKeyUp(e){
		var keynum;
		if(window.event) { // IE
			keynum = e.keyCode;
		}else if(e.which) { // Netscape/Firefox/Opera
			keynum = e.which;
		}
		if (keynum == 16 ) shift = false;
	}

	function ExibePagina(){
		
		if (!comecou){
			
			document.getElementById("chatList").innerHTML = "";
			document.formChat.msgTempoTotal.value = "";
			document.formChat.msgTempo.value = "";
			document.formChat.msgTempo.value = "";
		}
		
		comecou = true;
		if (shift){
			caracter = "SHIFT + " + caracter;
		}
		
		document.getElementById("chatList").innerHTML +=  texto + ", " + caracter + ", " + horaF;
		document.getElementById("msgTempo").value += "[" + texto + ", " + caracter + ", " + horaF +  "],";
		caracter = "";
		document.getElementById("chatList").innerHTML = "";
		document.getElementById("chatList").innerHTML = "tempo de escrita: " + tm + " segundos";
		tm = (tempoFim - tempoIni)/1000;
		formChat.msgTempoTotal.value = tm;
		caracter = "";
	}
</script>

<style type="text/css">
	body, html {
		margin: 0px;
		padding: 0px;
		height: 100%;
		width: 100%;
		font-size: 11px;
		font-family: 'Lucida Grande', Verdana, Arial;
	}
	#arrowchat_topo {
		background: #fff url(images/logo_tagarelas.png) no-repeat; 
		/* padding-left: 225px; */
		padding-top: 10px;
		font-family: Calibri;
		font-size: 17px;
		/* color: #FF5324;*/
		color: #000;
		}
	#digitacao {
		vertical-align: top; 
		transition: height 0.2s;
		-webkit-transition: height 0.2s; 
		-moz-transition: height 0.2s; 
	}
</style>
</h:head>

<h:body>
<h:form id="formChat" prependId="false">
<h:inputHidden id="apelido"   value="#{loginBean.login}" />
<h:inputHidden id="msgTempo"   value="#{chatBean.msgTempo}" />
<h:inputHidden id="msgTempoTotal"   value="#{chatBean.msgTempoTotal}" />
<h:inputHidden id="msgH"  value="#{chatBean.msgH}"  />
<h:inputHidden id="flgResposta"  value="0"/>
<h:inputHidden id="idMensagemPai" value="0"/>
<h:inputHidden id="nivelResposta" value="0"/>
<div id="arrowchat_sound_player_holder"></div>

<div id="arrowchat_popout_wrapper">
	<div id="arrowchat_topo">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<strong>Projetando o bate-papo genérico do Portal Tagarelas</strong>
		<span id="sair" style="position: absolute; right: 6px;">
			<h:commandLink id="fech" action="#{chatBean.saiu}" onclick="setCookie('sessaoExpirada','não',null);"> 	
				<f:param name="nomeUsuario" value="#{loginBean.usuario.nomeUsuario}" />
				<f:param name="idAgenda" value="#{agendaBean.idAgenda}" />
				<f:param name="idUsuario" value="#{loginBean.usuario.idUsuario}" />
				<img src="images/fechar.jpg" border="0" ></img>
			</h:commandLink>
		</span>
	</div>
	
	<div id="arrowchat_popout_left">
		<div id="arrowchat_popout_friends">
			<div id="arrowchat_userslist_available">
				<!-- <a href="">Link</a>-->
				<div>
					<ui:repeat var="elemento" value="#{application.getAttribute(salaChatBean.keyListaUsuarios)}" varStatus="status">
    					<div class="arrowchat_userlist">
    						<img src="#{elemento.url}"  class="arrowchat_userlist_avatar " width="30" height="30"/>
    						<span class="arrowchat_userscontentname">
    							<strong><h:outputText  value="#{elemento.nomeUsuario}"/></strong>
    						</span>
    						<span class="arrowchat_userscontentdot arrowchat_available"></span>
    					</div>
						<br/>
  					</ui:repeat>
				</div>
			</div>
			<div id="arrowchat_userslist_busy"></div>
			<div id="arrowchat_userslist_away"></div>
			<div id="arrowchat_userslist_offline"></div>
		</div>
	</div>
	<div id="chatList" style="display: none;"></div>
	<div id="arrowchat_popout_right">
		<div id="janela_chat">
			<div id="arrowchat_sala_conversa" class="arrowchat_popout_convo_wrapper arrowchat_popout_convo_focused">
				<div class="arrowchat_popout_convo" id="mensagens_Chat" > <!--style="height: 888px;">-->
					<!-- <h:outputText value="#{salaChatBean.conversa}" escape="false" /> -->
					<!-- <h:outputText value="#{salaChatBean.mensagens.get(salaChatBean.idAgendaAux)}" escape="false" /> -->
					<!-- <h:outputText value="#{session.getAttribute(salaChatBean.idAgendaStr)}" escape="false"/> -->
					
					<h:outputText value="#{application.getAttribute(salaChatBean.idAgendaStr)}" escape="false" />
				</div>
			</div>
		</div>
		<div id="arrowchat_digita">
			<div class="arrowchat_popout_input_container">
				<div class="arrowchat_popout_input_wrapper">
					<h:inputTextarea  id="digitacao"  value="#{chatBean.mensagem}" onkeypress="VerificaKeyDown(event);VerificaKeypress(event)" onkeyup="VerificaKeyUp(event)" onKeyDown="VerificaKeyDown(event)" class="arrowchat_popout_convo_input"/> 
					<div id="legenda" style="float: left; color: #B7B5B5">status...</div>
					<div id="submit" style="float: right; display: block">
						<h:commandLink id="lnkDeleteUser"  onclick="enviaMensagem()">  
							<h:commandButton id="btn" action="#{chatBean.enviarMensagemTipico}" value="Enviar" class="ui-button ui-widget ui-state-default ui-corner-all"  > 	
								<f:param name="idAgenda" value="#{agendaBean.idAgenda}" />
								<f:param name="idUsuario" value="#{loginBean.usuario.idUsuario}" />
								<f:param name="url" value="#{loginBean.usuario.url}" />
								<f:param name="flgResposta" value="0"/>
								<f:param name="idMensagemPai" value="0"/>
								<f:param name="nivelResposta" value="0"/>
							</h:commandButton>
						</h:commandLink> 
					</div>
							
					<div id="submitResposta" style="float: right; display: none;">
						<h:commandLink id="lnkResponderUser"  onclick="enviaMensagem()">  
							<h:commandButton id="btnResponder" action="#{chatBean.enviarMensagemTipico}" value="Responder" class="ui-button ui-widget ui-state-default ui-corner-all">
								<f:param name="idAgenda" value="#{agendaBean.idAgenda}" />
								<f:param name="idUsuario" value="#{loginBean.usuario.idUsuario}" />
								<f:param name="url" value="#{loginBean.usuario.url}" />
								<f:param name="flgResposta" value="1"/>
								<f:param name="idMensagemPai" value="$('#idMensagemPai').val()"/>
								<f:param name="nivelResposta" value="$('#nivelResposta').val()"/>
							</h:commandButton>
						</h:commandLink> 
					</div>
				</div>
			</div>	
			<!-- <h:outputText value="#{salaChatBean.alertaShow}" escape="false" />  -->
		</div>
	</div>
</div>
<div id="divVerificaSessao" style="display: none">
	<strong>Sua sessão expirou. O que deseja fazer?</strong><br/>
	<span id="sair">
		<h:commandButton id="sairSessao" action="#{chatBean.saiu}" value="Sair" class="ui-button ui-widget" onclick="setCookie('sessaoExpirada','não',null);"> 	
			<f:param name="nomeUsuario" value="#{loginBean.usuario.nomeUsuario}" />
			<f:param name="idAgenda" value="#{agendaBean.idAgenda}" />
			<f:param name="idUsuario" value="#{loginBean.usuario.idUsuario}" />
		</h:commandButton>
		<br /><br />
		<h:outputText value="Acrescentar mais " /><input type="text" size="3" id="tempoAdicionalSessao"/><h:outputText value=" segundos!" /><br />
		<input type="button" value="Prorrogar" class="ui-button ui-widget" onclick="ampliarSessao();"/>
		<!-- <h:commandButton id="aumentarSessao" action="#{chatBean.saiu}" value="Prorrogar" class="ui-button ui-widget"> 	
			<f:param name="nomeUsuario" value="#{loginBean.usuario.nomeUsuario}" />
			<f:param name="idAgenda" value="#{agendaBean.idAgenda}" />
			<f:param name="idUsuario" value="#{loginBean.usuario.idUsuario}" />
		</h:commandButton> -->
	</span>
</div>
</h:form>
</h:body>
</html>